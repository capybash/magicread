module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=flarum.core.compat["forum/app"]},,function(e,t){e.exports=flarum.core.compat["common/components/TextEditor"]},,,function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(2),i=n.n(o);function u(e){return e&&e.attrs&&e.attrs.composer&&e.attrs.composer.editor&&e.attrs.composer.editor.el||null}function c(e){var t=u(e);if(!t)return null;var n=t.closest(".Composer");if(!n)return null;var r=n.querySelector(".Composer-controls");if(!r)return null;var a=r.querySelector("li.item-magicread-counter"),o=null;if(a)o=a.querySelector(".MagicRead-CharCounter");else{var i=function(){var e=document.createElement("li");e.className="item-magicread-counter";var t=document.createElement("span");return t.className="MagicRead-CharCounter",t.textContent="0",t.setAttribute("aria-live","polite"),e.appendChild(t),{li:e,span:t}}();a=i.li,o=i.span,r.insertAdjacentElement("afterbegin",a)}return o}var l=null,s=null,d=null,m=null,p=!1;function f(){return!!document.querySelector(".DiscussionPage")}function v(){return window.matchMedia("(max-width: 800px)").matches}function g(){return!1!==a.a.forum.attribute("magicread_enable_pagination")}function h(){if(!a.a.current)return null;var e=null;if("function"==typeof a.a.current.get&&(e=a.a.current.get("stream")),!e&&a.a.current&&a.a.current.stream&&(e=a.a.current.stream),!e){var t=document.querySelector(".DiscussionPage .PostStream");t&&t.__stream&&(e=t.__stream)}return e||null}function y(){var e=a.a.current&&"function"==typeof a.a.current.get&&a.a.current.get("discussion")||null,t=e&&"function"==typeof e.commentCount?e.commentCount():0,n=Math.ceil((t||0)/20);return n>0?n:1}function b(e,t,n){var r=function(e){var t=parseInt(e,10);return(isNaN(t)||t<0)&&(t=0),String(t).length}(t)+(n||0);e.style.width=r+"ch"}function E(e){e.textContent="";var t=document.createElement("div");t.className="MagicRead-TimelinePager";var n=document.createElement("input");n.type="text",n.inputMode="numeric",n.autocomplete="off",n.className="MagicRead-Input";var r=document.createElement("span");r.className="MagicRead-Sep",r.textContent="/";var a=document.createElement("span");function o(){var e=n.value;e||(e="1"),function(e){var t=y(),n=parseInt(e,10);(!n||n<1)&&(n=1),n>t&&(n=t);var r=h(),a=20*(n-1),o=a+1;r&&"function"==typeof r.goToNumber?r.goToNumber(o):r&&"function"==typeof r.goToIndex&&r.goToIndex(a)}(e)}function i(){var e,t,r,o=(e=h(),t=e&&"number"==typeof e.index?e.index:0,(r=Math.floor(t/20)+1)>0?r:1),i=y();n.value=String(o),a.textContent=String(i),b(n,o,.5),b(a,i,.5)}return a.className="MagicRead-Total",t.appendChild(n),t.appendChild(r),t.appendChild(a),e.appendChild(t),n.addEventListener("input",(function(){var e=n.value.replace(/[^\d]/g,"");n.value=e,b(n,e||0,.5)})),n.addEventListener("keydown",(function(e){"Enter"===e.key&&o()})),n.addEventListener("blur",o),i(),i}function C(){if(f()&&!v())if(g()){var e=function(){var e=document.querySelector(".DiscussionPage .PostStreamScrubber");if(!e)return null;var t=e.parentElement?e.parentElement.querySelector(":scope > .MagicRead-TimelinePagerHost"):null;return t||((t=document.createElement("div")).className="MagicRead-TimelinePagerHost",e.insertAdjacentElement("afterend",t)),t}();if(e){l=E(e);var t=document.querySelector(".DiscussionPage .PostStream");t&&(s&&s.disconnect(),(s=new MutationObserver((function(){l&&l()}))).observe(t,{childList:!0,subtree:!0})),p||(window.addEventListener("popstate",S,{passive:!0}),window.addEventListener("hashchange",S,{passive:!0}),window.addEventListener("resize",x,{passive:!0}),p=!0)}}else R()}function R(){s&&(s.disconnect(),s=null);var e=document.querySelector(".MagicRead-TimelinePagerHost");e&&e.parentNode&&e.parentNode.removeChild(e),l=null}function S(){d&&clearTimeout(d),d=setTimeout((function(){f()&&!v()&&g()?(C(),l&&l()):R()}),60)}function x(){m&&clearTimeout(m),m=setTimeout((function(){S()}),120)}a.a.initializers.add("capybash-magicread",(function(){function e(){return!1!==a.a.forum.attribute("magicread_enable_counter")}var t=i.a.prototype.oncreate;i.a.prototype.oncreate=function(n){if(t&&t.call(this,n),e()){var r=c(this);this.magicReadCounterEl=r;var a=this;this.magicReadUpdate=function(){var e=u(a),t=e&&"string"==typeof e.value?e.value.length:0;a.magicReadCounterEl&&(a.magicReadCounterEl.textContent=String(t))};var o=u(this);o&&(o.addEventListener("input",this.magicReadUpdate),this.magicReadUpdate())}};var n=i.a.prototype.onupdate;i.a.prototype.onupdate=function(t){n&&n.call(this,t),e()&&(this.magicReadCounterEl&&document.body.contains(this.magicReadCounterEl)||(this.magicReadCounterEl=c(this),this.magicReadUpdate&&this.magicReadUpdate()))};var r=i.a.prototype.onremove;i.a.prototype.onremove=function(e){try{var t=u(this);t&&this.magicReadUpdate&&t.removeEventListener("input",this.magicReadUpdate);var n=this.magicReadCounterEl?this.magicReadCounterEl.closest(".item-magicread-counter"):null;n&&n.parentNode&&n.parentNode.removeChild(n)}catch(e){}r&&r.call(this,e)},document.addEventListener("DOMContentLoaded",(function(){S()})),setTimeout(S,0)}))}]);
//# sourceMappingURL=forum.js.map